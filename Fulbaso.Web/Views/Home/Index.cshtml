@using Fulbaso.Web
@using Fulbaso.Web.Models

@model IndexModel

@section StyleSheets
{
    <style>
        .fb_ltr, .fb-comments, .fb-comments iframe[style] { width: 100% !important; }
        .fb-like-box > span, #fbcomments, .fb_iframe_widget, .fb_iframe_widget[style], .fb_iframe_widget iframe[style], #fbcomments iframe[style] { width: 100% !important; }
    </style>
}
           
<div class="container" style="padding-left: 0; padding-right: 0;">
    <h3 style="margin-bottom: 10px;">¿Dónde querés jugar?</h3>

    <div class="row">
        <div class="span8">
            <p>Para realizar una búsqueda rápida ingresá a continuación el nombre de algún <b>barrio</b>, <b>ciudad</b>, <b>calle</b>, o bien el nombre de alguna <b>cancha</b> que ya conozcas:</p>
            <div style="margin-bottom: 20px;">
                @if (Request.QueryString.Count == 0)
                {
                    using (Html.BeginForm("Index", "Home", FormMethod.Post, new { @class = "form-horizontal" }))
                    {
                        <input id="searchtext" name="searchtext" class="input-xlarge" type="text" autocomplete="off" value="@ViewBag.Query" />
                        <button class="btn" type="submit">Buscar</button>
                    }
                }
            </div>
            <p>También podes probar haciendo una @Html.ActionLink("búsqueda avanzada", "Advanced", "Search") o buscar tu cancha en el @Html.ActionLink("listado completo", "Index", "Home", new { q = "*", }, null).</p>
            <div class="hidden-phone">
                <p>Existen @Html.ActionLink(Model.CourtsCount.ToString(), "Index", new { q = "*" }, new { @class = "badge badge-info" }) canchas disponibles en @Html.ActionLink(Model.PlacesCount.ToString(), "Index", new { q = "*" }, new { @class = "badge badge-info" }) complejos. @Html.ActionLink(Model.OwnedPlaces.ToString(), "Index", new { q = "*" }, new { @class = "badge badge-info" }) complejos siendo administrados.</p>
                <div style="display:none;">
                    <h4 style="margin-bottom: 10px;">Canchas mas cercanas:</h4>
                    <div id="nearestplaces"></div>
                    <div class="clearAll"></div>
                </div>
                <h4 style="margin-bottom: 10px;">Canchas mas usadas:</h4>
                @Html.Partial("List", Model.TopUsedPlaces)
                <div class="clearAll"></div>

                <h4 style="margin-bottom: 10px;">Canchas mas votadas:</h4>
                @Html.Partial("List", Model.TopVotedPlaces)
                <div class="clearAll"></div>
            </div>
        </div>
        <div class="span4 hidden-phone">
            <div id="mapheader" style="display:none; margin-bottom: 10px;">Navegá el mapa y buscá la cancha que te quede más cómoda. Hace click @Html.ActionLink("acá", "Map", "Place") para agrandar el mapa.</div>
            <div id="map_canvas" style="min-height: 350px; display:none; margin-bottom: 20px;"></div>
            <div class="fb-like-box" data-href="http://www.facebook.com/armateunfulbo" data-height="400" data-show-faces="true" data-stream="false" data-header="true"></div>
        </div>
        <div class="span4 visible-phone">
            <p>Navegá el mapa de canchas haciendo click @Html.ActionLink("acá", "Map", "Place").</p>
        </div>
    </div>
</div>

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script>
    $(function () {
        if ($(".hidden-phone").is(":visible")) {
            f.location.initialize("map_canvas", function (position) {
                $("#mapheader").fadeIn();
                f.map.mark("¡Estás acá! (en un radio de " + position.coords.accuracy + " metros)", position.coords.latitude, position.coords.longitude, "@Url.Content("~")img/user.png");
                f.map.markFrom("@Url.Action("GetNearestFromLocation", "Place")?lat=" + position.coords.latitude + "&lng=" + position.coords.longitude, "@Url.Content("~")img/sport_soccer.png");
                f.places.load("nearestplaces", "@Url.Action("GetNearestList", "Place")?lat=" + position.coords.latitude + "&lng=" + position.coords.longitude);
            });
        }
    });
</script>
